<!doctype html>
<html lang="ko">
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Cosmos - chatbot</title>

        <!-- CSS Linked -->
        <link rel="stylesheet" href="/assets/css/bootstrap.min.css">
        <link rel="stylesheet" href="/assets/css/aos.css">
        <link rel="stylesheet" href="/assets/css/boxicons.min.css">
        <link rel="stylesheet" href="/assets/css/owl.carousel.min.css">
        <link rel="stylesheet" href="/assets/css/magnific-popup.min.css">
        <link rel="stylesheet" href="/assets/css/nice-select.min.css">
        <link rel="stylesheet" href="/assets/css/flaticon.css">
        <link rel="stylesheet" href="/assets/css/header.css">
        <link rel="stylesheet" href="/assets/css/style.css">
        <link rel="stylesheet" href="/assets/css/responsive.css">
        
        <link rel="stylesheet" href="/assets/css/chatbot.css">

        <!-- favicon Linked -->
        <link rel="icon" type="image/png" href="/assets/img/all-img/favicon.png">

    </head>
    <body class="dark-theme">

        <main class="chat">

            <header class="chat-header">
                <p class="navbar-brand">cosmos</p>
                <div class="chat-btns">
                    <a href="/index.html" class="chat-icon"><i class='bx bx-home'></i></a>
                    <a href="#" class="chat-icon"><i class='bx bx-cog' ></i></a>
                </div>
            </header>
    
            <div class="chat-body">
                <div class="message-box">
                    <div class="message message-server hidden" id="chat-m1"><span>COSMOS 챗봇</span>입니다.<br>무엇을 도와드릴까요?</div>
                    <div class="message message-server hidden" id="chat-m2">
                        아래 카테고리에서 선택해주세요.
                        <div class="category-box">
                            <button class="btn-line c-btn">우주여행 패키지 문의</button>
                            <button class="btn-line c-btn">필요한 건강검진 문의</button>
                            <button class="btn-line c-btn">우주복, 장비 문의</button>
                            <button class="btn-line c-btn">상담원 연결</button>
                        </div>
                    </div>
                    <!-- <div class="message message-user"></div> -->
                </div>
            </div>
    
            <footer class="chat-footer">
                <button type="button" title="입력 도우미" class="chat-icon"><i class="bx bx-chat"></i></button>
                <textarea id="userInput" placeholder="질문하실 내용을 입력해 주세요." rows="1" maxlength="300"></textarea>
                <button type="button" title="입력내용 삭제" class="chat-clear"><i class="bx bx-x"></i></button>
                <button onclick="sendMessage()" type="button" title="전송" class="chat-icon send-btn"><i class="bx bx-send"></i></button>
                </div>
            </footer>

        </main>
        
        <!-- End Chatbot Section -->
        

        <script>
        /* 입력창 */
            const textarea = document.getElementById('userInput');
            const clearButton = document.querySelector('.chat-clear');
            textarea.focus();

            // 입력창 상태 업데이트
            function updateClearButtonState() {
                if (textarea.value.trim() !== '') {
                    clearButton.style.display = 'flex';
                } else {
                    clearButton.style.display = 'none';
                }
            }

            // 입력창 초기화 함수
            function clearInput() {
                textarea.value = '';
                textarea.focus();
                updateClearButtonState();
            }

            // 입력 이벤트 감지
            textarea.addEventListener('input', updateClearButtonState);

            // 삭제 버튼 클릭 이벤트
            clearButton.addEventListener('click', clearInput);



        /* 메시지 입력 */
            async function sendMessage() {
                const userInput = document.getElementById('userInput').value.trim();
    
                if (!userInput) {
                    return;
                }

                const messageBox = document.querySelector('.message-box');

                const userMessage = document.createElement('div');
                userMessage.classList.add('message', 'message-user');
                userMessage.textContent = userInput;

                messageBox.appendChild(userMessage);

                clearInput();

                messageBox.scrollTop = messageBox.scrollHeight;
            }

            document.getElementById('userInput').addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault(); // Enter의 기본 동작 차단
                    sendMessage(); // 메시지 전송
                }
            });




        /* 로딩(서버채팅 딜레이) */
            const chatM1 = document.getElementById('chat-m1');
            const chatM2 = document.getElementById('chat-m2');

            function showMessage(element, delay) {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        element.classList.remove('hidden');
                        resolve();
                    }, delay);
                });
            }

            async function displayMessages() {
                await showMessage(chatM1, 800);
                await showMessage(chatM2, 800);

                // 사용자 입력 활성화
                // userInput.disabled = false;
                // sendButton.disabled = false;

                // setTimeout(() => {
                //     userInput.focus();
                // }, 0)
            }

            displayMessages();



            /* 카테고리 선택 버튼 */
            const categoryBtns = document.querySelectorAll('.c-btn');

            // 버튼에 따른 답변 정의
            const responses = {
                "우주여행 패키지 문의": "우주여행 패키지는 다양한 코스가 있습니다. 자세한 사항은 여기를 참고하세요.",
                "필요한 건강검진 문의": "우주여행 전 건강검진 항목은 다음과 같습니다: 심박수, 혈압, 체력 검사.",
                "우주복, 장비 문의": "우주복과 장비는 패키지에 포함되어 있습니다. 추가 정보는 문의하세요.",
                "상담원 연결": "상담원이 곧 연결됩니다. 잠시만 기다려 주세요!"
            }






        </script>

        <!-- Links of JS files -->
        <script src="/assets/js/jquery.min.js"></script>
        <script src="/assets/js/bootstrap.min.js"></script>
        <script src="/assets/js/aos.js"></script>
        <script src="/assets/js/nice-select.min.js"></script>
        <script src="/assets/js/magnific-popup.min.js"></script>
        <script src="/assets/js/jquery.mixitup.min.js"></script>
        <script src="/assets/js/owl.carousel.min.js"></script>
        <script src="/assets/js/main.js"></script>
    </body>
</html>